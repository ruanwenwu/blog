[ 2017-03-26T00:22:42+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000248s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000356s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000394s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T00:22:42+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000010s ]
INFO: [ app_init ] --END-- [ RunTime:0.000220s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000274s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000354s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000030s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000078s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.004332s ]
INFO: [ view_parse ] --END-- [ RunTime:0.004368s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000109s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000179s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000301s ]
INFO: [ app_end ] --END-- [ RunTime:0.000334s ]

[ 2017-03-26T00:22:42+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000249s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000376s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000413s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000031s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000070s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.004627s ]
INFO: [ view_parse ] --END-- [ RunTime:0.004664s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000105s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000135s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000370s ]
INFO: [ app_end ] --END-- [ RunTime:0.000405s ]

[ 2017-03-26T00:22:44+08:00 ] 203.130.43.155 /admin.php/Ajax/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000243s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000305s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000340s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T00:22:44+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000010s ]
INFO: [ app_init ] --END-- [ RunTime:0.000217s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000272s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000309s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000063s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000103s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013207s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013243s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000106s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000138s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000354s ]
INFO: [ app_end ] --END-- [ RunTime:0.000391s ]

[ 2017-03-26T00:22:45+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000055s ]
INFO: [ app_init ] --END-- [ RunTime:0.000305s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000432s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000526s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0008s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000090s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000142s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.014131s ]
INFO: [ view_parse ] --END-- [ RunTime:0.014170s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000125s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000161s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000353s ]
INFO: [ app_end ] --END-- [ RunTime:0.000395s ]

[ 2017-03-26T00:37:13+08:00 ] 203.130.43.155 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000292s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000301s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000340s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
NOTIC: [8] Undefined index: id /data/wwwroot/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`content`,`pubtime`,`mtime`,`ctime`) VALUES ('sea.js快速入门','js','js模块化开发','js模块化开发棒棒哒，解决好多问题呢','<h3>一、模块化开发的意义</h3><p><strong>1.解决命名冲突。</strong></p><p>从一个故事说起。</p><p>有一天开发人员小王发现自己负责的业务突然出故障了。经过好一番排查发现是他们项目中公用的utile.js里（这是个超大的utile，简直就像百宝箱一样，这样的工具箱太可怕了），不知道被哪个&quot;坑货&quot;加了一个函数，把他之前用的那个函数覆盖了。</p><p>为了避免像这样的命名冲突的问题再发生，小组决定使用命名空间，于是函数名称变成了这样：orl.utile.changeStatus。</p><p>这样，虽然解决了冲突的问题，但是仍然存在很明显的弊端。一是文件名太长（还有比上面更长的），加重了开发人员的记忆负担；二是这样的用json格式的封装，里面的变量是可被操作的，这不符合封装的要求，容易被污染；三是这样一坨的东西放在一起，根本是不好用，也是不合理的。为什么工具需要分类呢？是为了更好的使用。而模块化正是实现了工具分类。</p><p><strong>2.解决依赖。</strong></p><p>我们在用jquery的插件的时候都知道要先引入jquery文件然后再引入jquery插件，是因为我们知道有这样的依赖关系，这没有问题。但是如果某个功能是项目中的一个成员A开发的，而这个功能又依赖那个功能，这下就有问题了。不论A告知大家这样的依赖关系，但总有人会忘记或者有新人来根部不知道，这样的问题会一直纠缠着A，永远永远，最后A疯了，放弃了程序员这个伟大的职业，转行卖煎饼去了。</p><p><br/></p><p>为了解决依赖的问题，雅虎就采用配置的方法，将这些依赖做声明，结果代码编程这样：</p><pre class=\"brush:as3;toolbar:false\">YUI.add(&#39;my-module&#39;,&nbsp;function&nbsp;(Y)&nbsp;{&nbsp;&nbsp;//&nbsp;...},&nbsp;&#39;0.0.1&#39;,&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;requires:&nbsp;[&#39;node&#39;,&nbsp;&#39;event&#39;]
});</pre><p>这都是些什么鬼，可读性差，配置太复杂了，要疯掉的啦~~</p><p>终于，后来有个叫玉伯的男人开发了一款叫sea.js的工具，完美了解决了上面两个问题，将无数的程序员从痛苦与绝望中拯救了出来。</p><h3>二、模块化的超简单步骤（先看看情况，再了解细节啊）</h3><p><strong>废话说在前面</strong></p><p>让所谓的AMD和CMD见鬼去吧，这些伤脑筋的玩意。不管你用require.js还是sea.js，明白模块的结构，会用模块化的方法去解决项目中的问题才是关键。这里我们只介绍sea.js的使用方法。</p><p>暂且不看单个模块怎么写，我们先看看模块是怎么关联部署的。</p><p>官方的例子已经比较简单了，但是刚开起来还是费劲。我总结了一下，也写了两个例子，其中一个超级简单的我删掉了，留了一个稍微有点意义的例子。总结起来就是3步走到位。</p><pre class=\"brush:as3;toolbar:false\">1.引入sea.js
2.给你的模块找个窝，然后把你写好的模块放到窝里。（就是放模块的目录^_^）
2.配置sea.js</pre><p>就是这么简单。</p><p>木有图，木有代码，木有链接，就木有真相，贴贴贴，都贴上：</p><p><strong>链接：</strong><a href=\"http://ruanwenwu.cn/index.php/Demo/Index/seajs\" target=\"_self\">http://ruanwenwu.cn/index.php/Demo/Index/seajs</a></p><p><strong>代码：</strong></p><pre class=\"brush:as3;toolbar:false\">&lt;extend&nbsp;name=&quot;Public:base&quot;&nbsp;/&gt;
&lt;block&nbsp;name=&quot;css&quot;&gt;
	&lt;style&gt;
		#div1{width:200px;height:200px;background:red;position:absolute;top:30;left:0;}
	&lt;/style&gt;
&lt;/block&gt;

&lt;block&nbsp;name=&quot;content&quot;&gt;
&lt;h1&gt;sea.js的实例&lt;/h1&gt;
&lt;div&nbsp;id=&quot;div1&quot;&gt;
&lt;/div&gt;
&lt;/block&gt;

&lt;block&nbsp;name=&quot;script&quot;&gt;
	&lt;script&nbsp;src=&quot;/Public/sea/sea.js&quot;&gt;&lt;/script&gt;
	&lt;script&gt;
	&nbsp;//&nbsp;Set&nbsp;configuration
		&nbsp;&nbsp;seajs.config({
			base:&nbsp;&quot;/Public/sea/modules/&quot;,
			alias:&nbsp;{
			&nbsp;&nbsp;&quot;jquery&quot;:&nbsp;&quot;jquery/jquery/1.10.1/jquery.js&quot;
			}
		&nbsp;&nbsp;});

		&nbsp;&nbsp;seajs.use(&quot;/Public/sea/app/demo_index_sea_main&quot;);
	&nbsp;&lt;/script&gt;
&lt;/block&gt;</pre><p>太xx的简洁了，(请自动忽略模板语言里的这些block,和extend)，简直符合洁癖强迫症患者的口味？有没有？</p><p><strong>我给大家看看我的模块的窝放的地方：/Public/sea/modules/</strong></p><p><img src=\"http://ruanwenwu.cn/Public/plugin/ueditor/themes/default/images/spacer.gif\"/><img src=\"/ueditor/php/upload/image/20170326/1490459239948024.png\" title=\"1490459239948024.png\" alt=\"blob.png\"/></p><p>这个窝放哪里都行，服务器能找到就可以。这里为什么会有一个app目录呢？这个app也是用来放模块的，只不是它只放业务模块，没有特定的功能，一般一个页面有一个。这个app目录是我自己设计的，不用它也是可以的。</p><p><strong>说明：</strong>流程就是sea.js调demo_index_sea_main.js这个模块，然后就没有然后了。后面的事就交给demo_index_sea_main.js这个模块去处理了，它可能找别的模块帮忙，那就是它的事了。</p><h3>三、现在知道Sea.js(CMD)模块部署的流程了，我们再回头来看一下单个模块是如何写的。</h3><p>简单粗暴就是贴代码。我将这个例子的两个模块贴一下：</p><p>demo_index_sea_main:</p><pre class=\"brush:as3;toolbar:false\">define(function(require){
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;alertModule&nbsp;=&nbsp;require(&quot;../modules/alertmodule&quot;);//引入alert模块
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;drag&nbsp;=&nbsp;require(&quot;../modules/perfectdrag&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;drag(&quot;div1&quot;);
});
perfectdrag.js</pre><p>perfectdrag.js:</p><pre class=\"brush:as3;toolbar:false\">define(function(require,exports,module){	
	function&nbsp;perfectDrag(ele){	
		var&nbsp;oDiv&nbsp;=&nbsp;document.getElementById(ele);			
		oDiv.onmousedown&nbsp;=&nbsp;function(){
			var&nbsp;pos&nbsp;=&nbsp;getPos();
			var&nbsp;diffX&nbsp;=&nbsp;pos.x&nbsp;-&nbsp;this.offsetLeft;
			var&nbsp;diffY&nbsp;=&nbsp;pos.y&nbsp;-&nbsp;this.offsetTop;
			var&nbsp;moveObj;
			
			if(oDiv.setCapture){
				moveObj&nbsp;=&nbsp;oDiv;
			}else{
				moveObj&nbsp;=&nbsp;document;
			}
			
			moveObj.onmousemove&nbsp;=&nbsp;mousemove;
			
			moveObj.onmouseup&nbsp;=&nbsp;function(){
				this.onmousemove&nbsp;=&nbsp;null;
				this.onmouseup&nbsp;&nbsp;&nbsp;=&nbsp;null;
				if(this.releaseCapture){
					this.releaseCapture();
				}
			}
			
			if(this.setCapture){
				this.setCapture();
			}
			
			return&nbsp;false;
			
			function&nbsp;mousemove(){
				var&nbsp;pos&nbsp;=&nbsp;getPos();
				oDiv.style.left&nbsp;=&nbsp;pos.x&nbsp;-&nbsp;diffX&nbsp;+&nbsp;&#39;px&#39;;
				oDiv.style.top&nbsp;&nbsp;=&nbsp;pos.y&nbsp;-&nbsp;diffY&nbsp;+&nbsp;&#39;px&#39;;
			}
		}
	
	}
	
	module.exports&nbsp;=&nbsp;perfectDrag;	#输出模块的功能。这就是那些所谓的API,整这些术语真是让人费解~~

	function&nbsp;getPos(){
		var&nbsp;sTop&nbsp;&nbsp;=&nbsp;document.documentElement.scrollTop&nbsp;||&nbsp;document.body.scrollTop;
		var&nbsp;sLeft&nbsp;=&nbsp;document.documentElement.scrollLeft&nbsp;||&nbsp;document.body.scrollLeft;
		var&nbsp;e=arguments.callee.caller.arguments[0]&nbsp;||&nbsp;window.event;&nbsp;
		return&nbsp;{x&nbsp;:&nbsp;sLeft&nbsp;+&nbsp;e.clientX,&nbsp;y&nbsp;:&nbsp;sTop&nbsp;+&nbsp;e.clientY};
	}
});</pre><p>解释一下上面的模块：</p><pre class=\"brush:as3;toolbar:false\">1.一般一个模块放一个文件，不用担心文件太多，影响加载速度，这个我们最后会有压缩工具&nbsp;来压缩和合并。
2.模块书写固定格式：
define(function(require,exports,module){
//code&nbsp;&nbsp;这里原来怎么写现在还怎么写
});
接受一个工厂方法，方法里的这三个变量分别是：加载模块的方法的引用，模块的exports变量（APID输出）的引用，模块信息的对象。这三个名称建议不要更改。不要问我为什么，感兴趣可以读一下源码。
3.引入模块的方法：
var&nbsp;a&nbsp;=&nbsp;require(&quot;b&quot;);//引入b模块，将模块的输出返回给变量a。说到模块的输出，那么什么是模块的输出呢？像这样：
define(function(require,exports,module){
function&nbsp;person(name){
this.name&nbsp;=&nbsp;name;
}
module.exports&nbsp;=&nbsp;person;
});
或者这样:
define(function(require,exports,module){
function&nbsp;add(a,b){
return&nbsp;a+b;
}
exports.add&nbsp;=&nbsp;add;
});</pre><p>最常用的就是这两种的，记太多也没意义了。exports是module.exports的引用，不能直接给exports赋值，这是错误的：exports = add;</p><h3>模块标志：（啥模块标志，就是怎么引模块）</h3><p>好啦，模块化的东西基本上就完了。如果有人还有疑问，可能是想问模块怎么引入的？这个引入的方法特别多。我建议只记住我下面说的就好了。</p><p>相对路径：永远相对于当前跑的这个文件。</p><p>绝对路径：这个就是完整路径，没什么好说的。</p><p>默认路径：就是不是以/或者.或者..开头的目录，相对于我们配置的base目录，如果没有配就相对于sea.js的文件目录。</p><p>压缩的先不说，还没做试验。其实不做影响也不大。现在的带宽不是问题，而且浏览器本身支持多任务，多个文件一起下，说不定更快哦。</p><p><br/></p>','1490459833','1490459833','1490459833') [ RunTime:0.0172s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'js' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = 'js模块化开发' LIMIT 1   [ RunTime:0.0001s ]
SQL: INSERT INTO `z_tag` (`name`) VALUES ('js模块化开发') [ RunTime:0.0001s ]

[ 2017-03-26T00:37:15+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000052s ]
INFO: [ app_init ] --END-- [ RunTime:0.000286s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000300s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000338s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000060s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000105s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013204s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013243s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000117s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000149s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000318s ]
INFO: [ app_end ] --END-- [ RunTime:0.000356s ]

[ 2017-03-26T00:37:15+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000245s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000304s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000342s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0001s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000057s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000109s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012739s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012776s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000152s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000184s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000308s ]
INFO: [ app_end ] --END-- [ RunTime:0.000345s ]

[ 2017-03-26T11:10:05+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000241s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000354s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000392s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T11:10:06+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000246s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000347s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000384s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000032s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000070s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.004347s ]
INFO: [ view_parse ] --END-- [ RunTime:0.004384s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000147s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000179s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000313s ]
INFO: [ app_end ] --END-- [ RunTime:0.000346s ]

[ 2017-03-26T11:10:09+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000292s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000306s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000345s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000031s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000069s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.004352s ]
INFO: [ view_parse ] --END-- [ RunTime:0.004389s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000106s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000137s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000381s ]
INFO: [ app_end ] --END-- [ RunTime:0.000415s ]

[ 2017-03-26T11:10:11+08:00 ] 203.130.43.155 /admin.php/Ajax/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000245s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000353s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000389s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T11:10:12+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000010s ]
INFO: [ app_init ] --END-- [ RunTime:0.000259s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000272s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000308s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000070s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000113s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013208s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013244s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000106s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000137s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000355s ]
INFO: [ app_end ] --END-- [ RunTime:0.000392s ]

[ 2017-03-26T11:10:15+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000243s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000352s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000388s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000066s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000105s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013240s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013275s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000110s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000141s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000318s ]
INFO: [ app_end ] --END-- [ RunTime:0.000354s ]

[ 2017-03-26T12:52:21+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000016s ]
INFO: [ app_init ] --END-- [ RunTime:0.000353s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000527s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000595s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T12:52:21+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000292s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000310s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000389s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000031s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000072s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.020043s ]
INFO: [ view_parse ] --END-- [ RunTime:0.020111s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000206s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000256s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000369s ]
INFO: [ app_end ] --END-- [ RunTime:0.000409s ]

[ 2017-03-26T12:52:22+08:00 ] 203.130.43.155 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000246s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000356s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000394s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000030s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000068s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.004351s ]
INFO: [ view_parse ] --END-- [ RunTime:0.004388s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000105s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000136s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000310s ]
INFO: [ app_end ] --END-- [ RunTime:0.000346s ]

[ 2017-03-26T12:52:26+08:00 ] 203.130.43.155 /admin.php/Ajax/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000244s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000349s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000385s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T12:52:31+08:00 ] 203.130.43.155 /admin.php/Ajax/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000244s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000300s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000335s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.

[ 2017-03-26T12:52:32+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000288s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000301s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000338s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000069s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000111s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.048215s ]
INFO: [ view_parse ] --END-- [ RunTime:0.048262s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000158s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000191s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000332s ]
INFO: [ app_end ] --END-- [ RunTime:0.000373s ]

[ 2017-03-26T12:52:32+08:00 ] 203.130.43.155 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000292s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000429s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000467s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0001s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000060s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000100s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 361 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 424 行.
NOTIC: [8] Undefined variable: hospitalInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 438 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013470s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013507s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000107s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000139s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000304s ]
INFO: [ app_end ] --END-- [ RunTime:0.000342s ]

[ 2017-03-26T13:55:56+08:00 ] 203.130.43.155 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000245s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000343s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000382s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
NOTIC: [8] Undefined index: id /data/wwwroot/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`content`,`pubtime`,`mtime`,`ctime`) VALUES ('linux环境下安装node.js和npm','node','js模块化开发','没想到装个Node花了这么长时间，记录一下过程，希望能帮助到一些人。','<h3>废话说在前头</h3><p>我是源码安装的。特别坑。make了差不多半个小时。还是建议使用二进制包。解压开就能直接用了。</p><h3>node.js安装（源码包安装）</h3><p><strong>下载</strong></p><p>我是在官网下的源码包</p><p>wget&nbsp;<a href=\"https://nodejs.org/dist/v6.10.1/node-v6.10.1.tar.gz\">https://nodejs.org/dist/v6.10.1/node-v6.10.1.tar.gz</a> </p><p><strong>解压,安装（等吧，make完好像经过了几个世纪）</strong></p><pre class=\"brush:as3;toolbar:false\">tar&nbsp;zxvf&nbsp;node-v6.10.1.tar.gz
cd&nbsp;node-v6.10.1
./configure&nbsp;--prefix=/usr/local/node
make&nbsp;&amp;&amp;&nbsp;make&nbsp;install</pre><p><strong>安装完后</strong></p><pre class=\"brush:as3;toolbar:false\">cd&nbsp;/usr/local/node/bin
node&nbsp;-v</pre><p>看看版本号。如果正常，接着装npm。</p><p><span style=\"color: rgb(255, 0, 0);\">注意，这儿要先把node命令安装到全局$PATH变量，否则安装npm会出错。</span></p><h3><span style=\"color: rgb(0, 0, 0);\">npm安装</span></h3><p><span style=\"color: rgb(0, 0, 0);\">node安装好，npm的源码包也包括在里面了，路径是：</span></p><p><img src=\"/ueditor/php/upload/image/20170326/1490507605495465.png\" title=\"1490507605495465.png\" alt=\"blob.png\"/></p><p>看到configure文件没？</p><pre class=\"brush:as3;toolbar:false\">./configure
make&nbsp;&amp;&amp;&nbsp;make&nbsp;isntall</pre><p>完工。</p>','1490507756','1490507756','1490507756') [ RunTime:0.1137s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0007s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'node' LIMIT 1   [ RunTime:0.0003s ]
SQL: INSERT INTO `z_category` (`name`) VALUES ('node') [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = 'js模块化开发' LIMIT 1   [ RunTime:0.0002s ]

[ 2017-03-26T13:55:57+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000259s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000312s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000350s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0181s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000069s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000132s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.018013s ]
INFO: [ view_parse ] --END-- [ RunTime:0.018058s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000137s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000169s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000356s ]
INFO: [ app_end ] --END-- [ RunTime:0.000394s ]

[ 2017-03-26T13:55:58+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000291s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000306s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000343s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0001s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000061s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000104s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013318s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013357s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000113s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000145s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000370s ]
INFO: [ app_end ] --END-- [ RunTime:0.000408s ]

[ 2017-03-26T14:56:54+08:00 ] 203.130.43.155 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000249s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000301s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000381s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
NOTIC: [8] Undefined index: id /data/wwwroot/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`content`,`pubtime`,`mtime`,`ctime`) VALUES ('nginx做代理和负载均衡','linux','nginx','nginx做代理就是，举个栗子，你让张三帮你去买个水果，那么张三就是代理。那么什么是负载均衡呢？再举个栗子，负载均衡就好像银行办理业务，客户拿到流水单号后，会被随机分配到不同的柜台，这些柜台一起办理业务，加快了业务的办理速度，减少了用户的等待时间，这就是负载均衡。','<h3>简单的代理</h3><p>这个代理实现通过代理服务器来访问ruanwenwu.cn的效果。</p><p><strong>首先修改代理服务器的hosts，让ruanwenwu.cn指向127.0.0.1</strong><br/></p><p>vim /etc/hosts</p><p><img src=\"/ueditor/php/upload/image/20170326/1490508279456387.png\" title=\"1490508279456387.png\" alt=\"图片.png\"/></p><p><strong>在/usr/local/nginx/conf/vhosts目录下建立proxy_test_single.conf文件：</strong></p><pre class=\"brush:as3;toolbar:false\">server{
&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;80;
&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;ruanwenwu.cn;
&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;/&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;http://101.200.168.135/;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#proxy_set_header&nbsp;Host&nbsp;$host;
&nbsp;&nbsp;&nbsp;&nbsp;}
}
这个配置的意思是，通过这台代理服务器访问ruanwenwu.cn的时候，将目的指向
这里有个问题，就是如果要成功的话，ruanwenwu.cn的网站的默认server是开放的才行，如果默认server是deny&nbsp;all，像下面这样，这个实验就该返回403了
&nbsp;
server
{
&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;80&nbsp;default_server;
&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;localhost;
&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;index.html&nbsp;index.htm&nbsp;index.php;
&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;/tmp/1233;
&nbsp;&nbsp;&nbsp;&nbsp;deny&nbsp;all;
}</pre><p>有人也叫上面这种default_server空主机头。好处就是你的网站不能通过ip访问，其他的子域名也不会都指向别的地方。配置好，检查一下nginx配置的语法，没问题就可以重新加载配置文件了。</p><p><strong>测试</strong></p><p>curl -x127.0.0.1:80 <a href=\"http://www.ruanwenwu.cn\">www.ruanwenwu.cn</a> -I 返回200说明成功了。 <br/></p><h3>通过nginx的upstream实现负载均衡</h3><p>现在我手上有3台服务器：10.21.93.208,10.21.93.205,10.21.93.204。205和204这两台都部署了网站111.com的程序。现在我想让10.21.93.208做为负载均衡服务器，让请求能够分发到205和204上面。</p><p>首先，我配置好了204和205的网站环境，让他们能够通过10.21.93.205:80和10.21.93.204:80都能够访问到。这一步只要去掉空主机头，让接受111.com访问的虚拟主机成功默认虚拟主机。贴上204和205其中一台的虚拟机配置：</p><pre class=\"brush:as3;toolbar:false\">server
{
&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;80&nbsp;default_server;
&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;www.111.com&nbsp;www.test.com;
&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;index.html&nbsp;index.htm&nbsp;index.php;
&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;/data/www/upload;
&nbsp;&nbsp;&nbsp;&nbsp;access_log&nbsp;/usr/local/nginx/logs/111.com.access.log;

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($http_user_agent&nbsp;~&nbsp;baidu|sougou|360)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;403;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($host&nbsp;!=&nbsp;&#39;www.111.com&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;^/(.*)$&nbsp;http://www.111.com/$1&nbsp;permanent;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;~&nbsp;.*admin\\.php$&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;#auth_basic&nbsp;&quot;ruanwenwu&nbsp;auth&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;#auth_basic_user_file&nbsp;/usr/local/nginx/conf/.htpasswd;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#allow&nbsp;127.0.0.1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#allow&nbsp;10.21.95.251;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#deny&nbsp;all;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;fastcgi_params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_pass&nbsp;unix:/tmp/www.sock;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_index&nbsp;index.php;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_param&nbsp;SCRIPT_FILENAME&nbsp;/data/www/upload$fastcgi_script_name;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;~&nbsp;\\.php$&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;fastcgi_params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#fastcgi_pass&nbsp;127.0.0.1:9000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_pass&nbsp;unix:/tmp/www.sock;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_index&nbsp;index.php;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_param&nbsp;SCRIPT_FILENAME&nbsp;/data/www/upload$fastcgi_script_name;
&nbsp;&nbsp;&nbsp;&nbsp;}

}</pre><p>现在，我们配置208上的负载均衡的配置：</p><p>vim 111.conf</p><pre class=\"brush:as3;toolbar:false\">upstream&nbsp;ruanwenwu&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;10.21.93.205:80;
&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;10.21.93.204:80;
}
server
{
&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;80;
&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;www.111.com&nbsp;www.test.com;

&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;/&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;http://ruanwenwu;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;HOST&nbsp;$host;
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>注意upstream后面的名称一定要拼写正确，而且upstream reuanwenwu后最好跟一个空格，就像上面代码贴的这样，否则就会一致报下面的错误：<br/></p><p>nginx: [emerg] host not found in upstream &quot;<span style=\"color: rgb(255, 0, 0);\">ruanewnwu</span>&quot; in /usr/local/nginx/conf/vhosts/111.conf:11<br/>最后的效果:</p><p><img src=\"/ueditor/php/upload/image/20170326/1490511196540142.png\" title=\"1490511196540142.png\" alt=\"图片.png\"/></p><p><img src=\"/ueditor/php/upload/image/20170326/1490511212562850.png\" title=\"1490511212562850.png\" alt=\"图片.png\"/></p><p>说明已经成功了，oh y!<br/></p>','1490511414','1490511414','1490511414') [ RunTime:0.0494s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0006s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'linux' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = 'nginx' LIMIT 1   [ RunTime:0.0001s ]

[ 2017-03-26T14:56:55+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000247s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000306s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000343s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000079s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000135s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013615s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013655s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000117s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000149s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000375s ]
INFO: [ app_end ] --END-- [ RunTime:0.000415s ]

[ 2017-03-26T14:56:56+08:00 ] 203.130.43.155 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000054s ]
INFO: [ app_init ] --END-- [ RunTime:0.000291s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000306s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000345s ]
NOTIC: [8] A session had already been started - ignoring session_start() /data/wwwroot/blog/ThinkPHP/Common/functions.php 第 1263 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0006s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0001s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0001s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000056s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000095s ]
NOTIC: [8] Undefined variable: userInfo /data/wwwroot/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 361 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012831s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012868s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000109s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000141s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000349s ]
INFO: [ app_end ] --END-- [ RunTime:0.000385s ]

