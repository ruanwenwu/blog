[ 2016-11-13T14:58:58+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000037s ]
INFO: [ app_init ] --END-- [ RunTime:0.000816s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001151s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001217s ]

[ 2016-11-13T14:58:58+08:00 ] 127.0.0.1 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000376s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000382s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000417s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000051s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000090s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.008409s ]
INFO: [ view_parse ] --END-- [ RunTime:0.008484s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000507s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000556s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.002097s ]
INFO: [ app_end ] --END-- [ RunTime:0.002146s ]

[ 2016-11-13T14:58:58+08:00 ] 127.0.0.1 /admin.php/Login/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000508s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001291s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001369s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000057s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000100s ]
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015182s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015304s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000201s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000230s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000534s ]
INFO: [ app_end ] --END-- [ RunTime:0.000570s ]

[ 2016-11-13T14:59:00+08:00 ] 127.0.0.1 /admin.php/Ajax/login
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000226s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000367s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000390s ]

[ 2016-11-13T14:59:00+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.000447s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000670s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000723s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0018s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000148s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000179s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013461s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013498s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000182s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000211s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000826s ]
INFO: [ app_end ] --END-- [ RunTime:0.000879s ]

[ 2016-11-13T14:59:01+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000483s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000366s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000390s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000240s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000302s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012163s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012201s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000151s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000168s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000412s ]
INFO: [ app_end ] --END-- [ RunTime:0.000441s ]

[ 2016-11-13T14:59:30+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000571s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000588s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000629s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0028s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0014s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000195s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000231s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.016141s ]
INFO: [ view_parse ] --END-- [ RunTime:0.016180s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000528s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000564s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000889s ]
INFO: [ app_end ] --END-- [ RunTime:0.000936s ]

[ 2016-11-13T14:59:30+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000370s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000279s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000304s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0013s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000176s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000219s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.007286s ]
INFO: [ view_parse ] --END-- [ RunTime:0.007317s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000160s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000195s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000794s ]
INFO: [ app_end ] --END-- [ RunTime:0.000856s ]

[ 2016-11-13T14:59:31+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000038s ]
INFO: [ app_init ] --END-- [ RunTime:0.000276s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001111s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001222s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000192s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000246s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010581s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010603s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000110s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000126s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000374s ]
INFO: [ app_end ] --END-- [ RunTime:0.000397s ]

[ 2016-11-13T14:59:32+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000422s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000383s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000428s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0041s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000169s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000211s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010153s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010185s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000136s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000155s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000467s ]
INFO: [ app_end ] --END-- [ RunTime:0.000504s ]

[ 2016-11-13T14:59:33+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000006s ]
INFO: [ app_init ] --END-- [ RunTime:0.000189s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000241s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000263s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0097s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0015s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000149s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000179s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010491s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010525s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000103s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000119s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000668s ]
INFO: [ app_end ] --END-- [ RunTime:0.000728s ]

[ 2016-11-13T14:59:33+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000231s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000360s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000399s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0013s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000298s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000432s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012918s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012954s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000211s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000243s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000596s ]
INFO: [ app_end ] --END-- [ RunTime:0.000635s ]

[ 2016-11-13T14:59:41+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000023s ]
INFO: [ app_init ] --END-- [ RunTime:0.000396s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000653s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000757s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0098s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0019s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000172s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000203s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010835s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010875s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000147s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000167s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000399s ]
INFO: [ app_end ] --END-- [ RunTime:0.000426s ]

[ 2016-11-13T14:59:41+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000233s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000471s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000513s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000170s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000209s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.009281s ]
INFO: [ view_parse ] --END-- [ RunTime:0.009316s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000188s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000218s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000585s ]
INFO: [ app_end ] --END-- [ RunTime:0.000628s ]

[ 2016-11-13T15:00:35+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000020s ]
INFO: [ app_init ] --END-- [ RunTime:0.000943s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001412s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001537s ]
NOTIC: [8] Undefined index: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0038s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`content`,`pubtime`,`mtime`,`ctime`) VALUES ('不要跑，当你还没学会走之前','说说','','','','1479020435','1479020435','1479020435') [ RunTime:0.0152s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0022s ]
SQL: SELECT * FROM `z_category` WHERE `name` = '说说' LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '' LIMIT 1   [ RunTime:0.0003s ]
SQL: INSERT INTO `z_tag` (`name`) VALUES ('') [ RunTime:0.0011s ]

[ 2016-11-13T15:00:37+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000016s ]
INFO: [ app_init ] --END-- [ RunTime:0.000469s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000316s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000346s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0041s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000142s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000170s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012600s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012648s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000663s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000760s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000957s ]
INFO: [ app_end ] --END-- [ RunTime:0.001040s ]

[ 2016-11-13T15:00:37+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000201s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000334s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000364s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0101s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000163s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000198s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012694s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012731s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000122s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000141s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000425s ]
INFO: [ app_end ] --END-- [ RunTime:0.000458s ]

[ 2016-11-13T15:01:26+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000010s ]
INFO: [ app_init ] --END-- [ RunTime:0.000284s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000399s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000440s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0006s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000212s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000260s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.008998s ]
INFO: [ view_parse ] --END-- [ RunTime:0.009023s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000137s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000158s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000470s ]
INFO: [ app_end ] --END-- [ RunTime:0.000499s ]

[ 2016-11-13T15:01:27+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000274s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000434s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000469s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000201s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.008391s ]
INFO: [ view_parse ] --END-- [ RunTime:0.008423s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000192s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000225s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000555s ]
INFO: [ app_end ] --END-- [ RunTime:0.000596s ]

[ 2016-11-13T15:01:54+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000023s ]
INFO: [ app_init ] --END-- [ RunTime:0.000859s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001089s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001144s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0022s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000205s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000253s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015819s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015847s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000454s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000485s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000888s ]
INFO: [ app_end ] --END-- [ RunTime:0.000933s ]

[ 2016-11-13T15:01:55+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000368s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000466s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000509s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0015s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0007s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000190s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000248s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011153s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011220s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000150s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000173s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000427s ]
INFO: [ app_end ] --END-- [ RunTime:0.000464s ]

[ 2016-11-13T15:04:34+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000646s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000728s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000771s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0035s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0006s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0035s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000236s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000286s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015197s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015236s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000470s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000510s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001339s ]
INFO: [ app_end ] --END-- [ RunTime:0.001401s ]

[ 2016-11-13T15:04:35+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000478s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000523s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000671s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0036s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0040s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000192s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012257s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012324s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000191s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000224s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000572s ]
INFO: [ app_end ] --END-- [ RunTime:0.000619s ]

[ 2016-11-13T15:06:03+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000696s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000929s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000989s ]
NOTIC: [8] Undefined index: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0043s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`pubtime`,`mtime`,`ctime`) VALUES ('怀念友情','说说','','','1479020763','1479020763','1479020763') [ RunTime:0.0043s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0020s ]
SQL: SELECT * FROM `z_category` WHERE `name` = '说说' LIMIT 1   [ RunTime:0.0006s ]

[ 2016-11-13T15:06:08+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000279s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000325s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000348s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0036s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000452s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000570s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015728s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015757s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000368s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000395s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000931s ]
INFO: [ app_end ] --END-- [ RunTime:0.000974s ]

[ 2016-11-13T15:06:09+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000403s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000488s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000530s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0107s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000162s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000198s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.009003s ]
INFO: [ view_parse ] --END-- [ RunTime:0.009031s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000124s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000143s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000527s ]
INFO: [ app_end ] --END-- [ RunTime:0.000567s ]

[ 2016-11-13T15:08:29+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000273s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000465s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000514s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000248s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000325s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.014261s ]
INFO: [ view_parse ] --END-- [ RunTime:0.014294s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000167s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000193s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000479s ]
INFO: [ app_end ] --END-- [ RunTime:0.000510s ]

[ 2016-11-13T15:08:30+08:00 ] 127.0.0.1 /admin.php
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000239s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000287s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000312s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000203s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 371 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 434 行.
NOTIC: [8] Undefined variable: hospitalInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b595b808c2ebeeeb0478ffc30bb4e87a.php 第 448 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010609s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010673s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000556s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000653s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000754s ]
INFO: [ app_end ] --END-- [ RunTime:0.000850s ]

[ 2016-11-13T16:35:14+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000634s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000903s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000993s ]
NOTIC: [8] Undefined index: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 53 行.
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0047s ]
SQL: INSERT INTO `z_post` (`title`,`category`,`tag`,`summary`,`content`,`pubtime`,`mtime`,`ctime`) VALUES ('php框架原理','php','框架','框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。','<h2>说在题外的话</h2><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p>','1479026114','1479026114','1479026114') [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0069s ]
SQL: INSERT INTO `z_category` (`name`) VALUES ('php') [ RunTime:0.0016s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0020s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0002s ]
SQL: INSERT INTO `z_tag` (`name`) VALUES ('框架') [ RunTime:0.0010s ]

[ 2016-11-13T16:35:16+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000377s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000345s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000380s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0015s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0007s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000463s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000508s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013026s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013075s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000382s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000407s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000989s ]
INFO: [ app_end ] --END-- [ RunTime:0.001042s ]

[ 2016-11-13T16:35:16+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000412s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000438s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000471s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0017s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000143s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000174s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.009809s ]
INFO: [ view_parse ] --END-- [ RunTime:0.009831s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000108s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000124s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000519s ]
INFO: [ app_end ] --END-- [ RunTime:0.000567s ]

[ 2016-11-13T16:35:25+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000302s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000340s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000366s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0012s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000163s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000192s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010839s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010864s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000122s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000142s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000684s ]
INFO: [ app_end ] --END-- [ RunTime:0.000717s ]

[ 2016-11-13T16:35:26+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000241s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000290s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000315s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0018s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0016s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0025s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000169s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000208s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010400s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010449s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000126s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000143s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000571s ]
INFO: [ app_end ] --END-- [ RunTime:0.000610s ]

[ 2016-11-13T16:48:30+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000890s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000939s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001040s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0039s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><h2>说在题外的话</h2><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><p><br/></p><h2>框架原理</h2><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p><p></p><p></p></li></ol><p><br/></p><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><p><br/></p><h2>目录</h2><p><img src=\"/ueditor/php/upload/image/20161113/1479026814879694.png\" title=\"1479026814879694.png\" alt=\"78A7DF02-5D84-4396-AD69-A551B7BCA90B.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。</p><p><br/></p><p><br/></p><p><br/></p><p>							</p>',`mtime`='1479026910' WHERE `id` = 19 [ RunTime:0.0039s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0029s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0002s ]

[ 2016-11-13T16:48:33+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000023s ]
INFO: [ app_init ] --END-- [ RunTime:0.000651s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000602s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000682s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0056s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0020s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000177s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000218s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.017165s ]
INFO: [ view_parse ] --END-- [ RunTime:0.017214s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000471s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000513s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001461s ]
INFO: [ app_end ] --END-- [ RunTime:0.001520s ]

[ 2016-11-13T16:48:33+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000235s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000493s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000547s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0104s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000161s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000196s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011811s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011848s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000136s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000154s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001231s ]
INFO: [ app_end ] --END-- [ RunTime:0.001311s ]

[ 2016-11-13T16:51:30+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000640s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000838s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000880s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0022s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0005s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0019s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0007s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0020s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000199s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000268s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015745s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015776s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000480s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000518s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000947s ]
INFO: [ app_end ] --END-- [ RunTime:0.000991s ]

[ 2016-11-13T16:51:31+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000352s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001376s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001432s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0023s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0032s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0019s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000167s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000203s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012033s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012094s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000184s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000214s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001350s ]
INFO: [ app_end ] --END-- [ RunTime:0.001404s ]

[ 2016-11-13T16:52:42+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000016s ]
INFO: [ app_init ] --END-- [ RunTime:0.001115s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001089s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001156s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0040s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><p><br/></p><h2>说在题外的话</h2><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h2>框架原理<br/></h2><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h2>目录</h2><p><img src=\"/ueditor/php/upload/image/20161113/1479026814879694.png\" title=\"1479026814879694.png\" alt=\"78A7DF02-5D84-4396-AD69-A551B7BCA90B.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>							</p>',`mtime`='1479027162' WHERE `id` = 19 [ RunTime:0.0020s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0003s ]

[ 2016-11-13T16:52:44+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000007s ]
INFO: [ app_init ] --END-- [ RunTime:0.000275s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000281s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000307s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0016s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0007s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000274s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000363s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.016410s ]
INFO: [ view_parse ] --END-- [ RunTime:0.016460s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000699s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000735s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.002157s ]
INFO: [ app_end ] --END-- [ RunTime:0.002279s ]

[ 2016-11-13T16:52:45+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000418s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000915s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001027s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0095s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0009s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000185s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000238s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010828s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010905s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000830s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000897s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001198s ]
INFO: [ app_end ] --END-- [ RunTime:0.001329s ]

[ 2016-11-13T16:53:32+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000618s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000857s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000918s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0035s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0006s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000243s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000344s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012657s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012698s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000614s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000662s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001024s ]
INFO: [ app_end ] --END-- [ RunTime:0.001071s ]

[ 2016-11-13T16:53:33+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.001638s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000509s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000555s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0017s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0009s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000246s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000318s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012196s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012241s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000250s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000292s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000668s ]
INFO: [ app_end ] --END-- [ RunTime:0.000767s ]

[ 2016-11-13T16:54:00+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000010s ]
INFO: [ app_init ] --END-- [ RunTime:0.000406s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000421s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000454s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0016s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><h2>说在题外的话<br/></h2><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h2>框架原理<br/></h2><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h2>目录</h2><p><img src=\"/ueditor/php/upload/image/20161113/1479026814879694.png\" title=\"1479026814879694.png\" alt=\"78A7DF02-5D84-4396-AD69-A551B7BCA90B.png\"/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>							</p>',`mtime`='1479027240' WHERE `id` = 19 [ RunTime:0.0015s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0003s ]

[ 2016-11-13T16:54:01+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000023s ]
INFO: [ app_init ] --END-- [ RunTime:0.000602s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000434s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000471s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0093s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000207s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000245s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011659s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011698s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000153s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000173s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000466s ]
INFO: [ app_end ] --END-- [ RunTime:0.000494s ]

[ 2016-11-13T16:54:02+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000007s ]
INFO: [ app_init ] --END-- [ RunTime:0.000195s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000278s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000301s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0108s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000162s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000199s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.017632s ]
INFO: [ view_parse ] --END-- [ RunTime:0.017664s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000129s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000149s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000780s ]
INFO: [ app_end ] --END-- [ RunTime:0.000962s ]

[ 2016-11-13T16:59:00+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000016s ]
INFO: [ app_init ] --END-- [ RunTime:0.000817s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000945s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000998s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0046s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0005s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000196s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.014757s ]
INFO: [ view_parse ] --END-- [ RunTime:0.014802s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000492s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000531s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000931s ]
INFO: [ app_end ] --END-- [ RunTime:0.001003s ]

[ 2016-11-13T16:59:01+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000392s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000434s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000476s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000262s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000337s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010554s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010595s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000208s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000243s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000574s ]
INFO: [ app_end ] --END-- [ RunTime:0.000614s ]

[ 2016-11-13T17:06:33+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000020s ]
INFO: [ app_init ] --END-- [ RunTime:0.000824s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000833s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000920s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0049s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><h3>题外话</h3><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h3>框架原理<br/></h3><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h3>目录</h3><p><img src=\"/ueditor/php/upload/image/20161113/1479026814879694.png\" title=\"1479026814879694.png\" alt=\"78A7DF02-5D84-4396-AD69-A551B7BCA90B.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p>目录很简单。app里放业务。core里是核心文件和类库。.htaccess负责将请求指向index.php，入口文件index.php。我有理由相信，如果你对php的命名空间，自动加载，类和对象的知识比较熟悉的话，半个小时你就能掌握这个小东西。</p><p><br/></p><h3>index.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;入口文件
&nbsp;*&nbsp;1.定义常量
&nbsp;*&nbsp;2.加载函数库
&nbsp;*&nbsp;3.运行框架
&nbsp;*/
define(&quot;PROJECT_PATH&quot;,realpath(&quot;./&quot;).&quot;/&quot;);
define(&quot;APP_PATH&quot;,PROJECT_PATH.&quot;app/&quot;);
define(&quot;CORE&quot;,PROJECT_PATH.&quot;core/&quot;);
define(&quot;MODULE&quot;,&#39;app&#39;);
define(&quot;DEBUG&quot;,true);
include(&quot;vendor/autoload.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//引入composer自动加载文件

if(DEBUG){
&nbsp;&nbsp;&nbsp;&nbsp;$whoops&nbsp;=&nbsp;new&nbsp;\\Whoops\\Run;
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;pushHandler(new&nbsp;\\Whoops\\Handler\\PrettyPageHandler);
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;register();
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;On&quot;);
}else{
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;Off&quot;);
}

include&nbsp;CORE.&quot;common/functions.php&quot;;
include&nbsp;CORE.&quot;core.php&quot;;
spl_autoload_register(&#39;core\\Core::load&#39;);
core\\Core::run();</pre><p>这里定义了几个常量。引入了common/function.php这个供系统使用的函数库。然后，引入框架核心文件core.php，最后调用core.php中的core类下的load方法进行自动加载配置。最后运行core类下的run方法运行整个框架。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>							</p>',`mtime`='1479027993' WHERE `id` = 19 [ RunTime:0.0025s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0015s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0004s ]

[ 2016-11-13T17:06:34+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000231s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000287s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000324s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0019s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000234s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000271s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015918s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015957s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000582s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000630s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001005s ]
INFO: [ app_end ] --END-- [ RunTime:0.001056s ]

[ 2016-11-13T17:06:35+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.000425s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000479s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000535s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0014s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000304s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000369s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012172s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012202s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000145s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000166s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000451s ]
INFO: [ app_end ] --END-- [ RunTime:0.000480s ]

[ 2016-11-13T17:12:18+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000644s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000910s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000967s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0031s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000160s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000190s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015806s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015854s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000497s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000537s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000742s ]
INFO: [ app_end ] --END-- [ RunTime:0.000778s ]

[ 2016-11-13T17:12:19+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000398s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000351s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000382s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0019s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0009s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0015s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000201s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010728s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010763s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000208s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000232s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000578s ]
INFO: [ app_end ] --END-- [ RunTime:0.000620s ]

[ 2016-11-13T17:21:59+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000017s ]
INFO: [ app_init ] --END-- [ RunTime:0.000854s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001659s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001730s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0033s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000194s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000234s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011758s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011793s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000412s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000444s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000857s ]
INFO: [ app_end ] --END-- [ RunTime:0.000892s ]

[ 2016-11-13T17:22:14+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000013s ]
INFO: [ app_init ] --END-- [ RunTime:0.000482s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000594s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000638s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0102s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0005s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0031s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0010s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0016s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000168s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000201s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011747s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011775s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000113s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000130s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000413s ]
INFO: [ app_end ] --END-- [ RunTime:0.000438s ]

[ 2016-11-13T17:22:15+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.000599s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000456s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000500s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0020s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0021s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0022s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0004s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000201s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.010253s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010291s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000120s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000138s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000577s ]
INFO: [ app_end ] --END-- [ RunTime:0.000616s ]

[ 2016-11-13T17:38:23+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000018s ]
INFO: [ app_init ] --END-- [ RunTime:0.000730s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000808s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000860s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0052s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><p><br/></p><h3>题外话</h3><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h3>框架原理<br/></h3><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h3>目录</h3><p><img src=\"/ueditor/php/upload/image/20161113/1479029828670748.png\" title=\"1479029828670748.png\" alt=\"blob.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p>目录很简单。app里放业务。core里是核心文件和类库。.htaccess负责将请求指向index.php，入口文件index.php。我有理由相信，如果你对php的命名空间，自动加载，类和对象的知识比较熟悉的话，半个小时你就能掌握这个小东西。</p><p><br/></p><h3>index.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;入口文件
&nbsp;*&nbsp;1.定义常量
&nbsp;*&nbsp;2.加载函数库
&nbsp;*&nbsp;3.运行框架
&nbsp;*/
define(&quot;PROJECT_PATH&quot;,realpath(&quot;./&quot;).&quot;/&quot;);
define(&quot;APP_PATH&quot;,PROJECT_PATH.&quot;app/&quot;);
define(&quot;CORE&quot;,PROJECT_PATH.&quot;core/&quot;);
define(&quot;MODULE&quot;,&#39;app&#39;);
define(&quot;DEBUG&quot;,true);
include(&quot;vendor/autoload.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//引入composer自动加载文件

if(DEBUG){
&nbsp;&nbsp;&nbsp;&nbsp;$whoops&nbsp;=&nbsp;new&nbsp;\\Whoops\\Run;
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;pushHandler(new&nbsp;\\Whoops\\Handler\\PrettyPageHandler);
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;register();
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;On&quot;);
}else{
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;Off&quot;);
}

include&nbsp;CORE.&quot;common/functions.php&quot;;
include&nbsp;CORE.&quot;core.php&quot;;
spl_autoload_register(&#39;core\\Core::load&#39;);
core\\Core::run();</pre><p>这里定义了几个常量。引入了common/function.php这个供系统使用的函数库。然后，引入框架核心文件core.php，最后调用core.php中的core类下的load方法进行自动加载配置。最后运行core类下的run方法运行整个框架。</p><p><br/></p><p>接下来我们看看框架的核心文件core.php。</p><p><br/></p><h3>core.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;框架核心文件，负责加载类，解析路由等
&nbsp;*/
namespace&nbsp;core;

class&nbsp;Core
{
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;$classMap&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;load($class){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classDir&nbsp;=&nbsp;str_replace(&quot;\\\\&quot;,&quot;/&quot;,$class);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classPath&nbsp;=&nbsp;PROJECT_PATH.$classDir.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($class,self::$classMap)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($classPath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$classPath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$classMap[]&nbsp;=&nbsp;$class;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;run(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router&nbsp;=&nbsp;new&nbsp;\\core\\lib\\Router();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrl&nbsp;=&nbsp;\\core\\lib\\Router::$ctrl;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$act&nbsp;=&nbsp;\\core\\lib\\Router::$act;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;=&nbsp;\\core\\lib\\Router::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlClass&nbsp;=&nbsp;&quot;\\\\&quot;.MODULE.&quot;\\\\controller\\\\&quot;.$ctrl.&quot;Controller&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj&nbsp;=&nbsp;new&nbsp;$ctrlClass();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj-&gt;$act();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>如果您曾经读过其他框架的源码，那么core.php将是你见过最短的框架核心文件。它只有两个方法。</p><p><br/></p><p>load方法用在index.php中来初始化自动加载。spl_autoload_register方法能接收带有命名空间的类名，并根据方法中定义的规则引入指定的类。</p><p><br/></p><p>run用在index.php启动整个框架。实际上它只做了一件事，就是将Router类中得到的控制器和方法名称拿来，拼接出我们最终需要进入的控制器和方法，并进行实例化和调用。<br/></p><p><br/></p><p>我们看到core类中只用到一个其他的类：Router。我们来看看它长什么样吧。</p><h3>Router</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Router
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$ctrl;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$act;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$params;

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_SERVER[&#39;REQUEST_URI&#39;]&nbsp;==&nbsp;&quot;/&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;Config::get(&quot;CTRL&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;&nbsp;=&nbsp;Config::get(&quot;ACTION&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathArr&nbsp;=&nbsp;explode(&quot;/&quot;,trim($_SERVER[&#39;REQUEST_URI&#39;],&quot;/&quot;));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathNum&nbsp;=&nbsp;count($pathArr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathNum&nbsp;==&nbsp;1){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;&quot;index&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if($pathNum&nbsp;==&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for($i&nbsp;=&nbsp;2;&nbsp;$i&nbsp;&lt;&nbsp;$pathNum&nbsp;-&nbsp;1&nbsp;;&nbsp;$i&nbsp;+=&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathArr[$i+1]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$params[$pathArr[$i]]&nbsp;=&nbsp;$pathArr[$i+1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_GET&nbsp;=&nbsp;self::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

}</pre><p>这个路由类只有一个构造函数。它的作用就是根据当前的url得到我们需要的控制器和方法名称，并把参数放到$_GET这个超全局变量中。</p><p><br/></p><p>到这里，我们已经可以在对应的控制器里写业务逻辑了。我们来看看控制器。</p><h3>controller</h3><p>以IndexController为例：</p><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;app\\controller;
use&nbsp;core\\lib\\Model&nbsp;as&nbsp;Model;
use&nbsp;core\\lib\\Router&nbsp;as&nbsp;Router;
use&nbsp;core\\lib\\View&nbsp;as&nbsp;View;
class&nbsp;IndexController
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;addData(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;insert&nbsp;into&nbsp;z_post&nbsp;(title,content)&nbsp;values&nbsp;(&#39;this&nbsp;is&nbsp;test&#39;,&#39;this&nbsp;i&nbsp;test&#39;)&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pdo-&gt;insertData($sql)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;chenggong&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;a&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;b&#39;];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;select&nbsp;*&nbsp;from&nbsp;z_post&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$pdo-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view&nbsp;=&nbsp;new&nbsp;View();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;assign(&quot;data&quot;,$data[0]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;display();
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;p(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;pre&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump(Router::$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;Router::$params[&#39;id&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/></p><p><br/></p><p>							</p>',`mtime`='1479029903' WHERE `id` = 19 [ RunTime:0.0052s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0002s ]

[ 2016-11-13T17:38:25+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000235s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000289s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000314s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0014s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0002s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000245s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000288s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.018404s ]
INFO: [ view_parse ] --END-- [ RunTime:0.018431s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000892s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000944s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001650s ]
INFO: [ app_end ] --END-- [ RunTime:0.001721s ]

[ 2016-11-13T17:38:25+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000229s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000592s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000633s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000160s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000195s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.007953s ]
INFO: [ view_parse ] --END-- [ RunTime:0.007988s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000140s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000163s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000564s ]
INFO: [ app_end ] --END-- [ RunTime:0.000596s ]

[ 2016-11-13T17:40:59+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000023s ]
INFO: [ app_init ] --END-- [ RunTime:0.000931s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000736s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000781s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0036s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000160s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000191s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.014603s ]
INFO: [ view_parse ] --END-- [ RunTime:0.014639s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.001054s ]
INFO: [ view_filter ] --END-- [ RunTime:0.001110s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001003s ]
INFO: [ app_end ] --END-- [ RunTime:0.001066s ]

[ 2016-11-13T17:41:00+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000014s ]
INFO: [ app_init ] --END-- [ RunTime:0.000504s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000450s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000489s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0016s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0011s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000169s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000207s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013127s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013163s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000158s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000179s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000413s ]
INFO: [ app_end ] --END-- [ RunTime:0.000445s ]

[ 2016-11-13T17:59:45+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.000878s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001068s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001133s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0048s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><p><br/></p><p><br/></p><h3>题外话</h3><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h3>框架原理<br/></h3><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h3>目录</h3><p><img src=\"/ueditor/php/upload/image/20161113/1479029828670748.png\" title=\"1479029828670748.png\" alt=\"blob.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p>目录很简单。app里放业务。core里是核心文件和类库。.htaccess负责将请求指向index.php，入口文件index.php。我有理由相信，如果你对php的命名空间，自动加载，类和对象的知识比较熟悉的话，半个小时你就能掌握这个小东西。</p><p><br/></p><h3>index.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;入口文件
&nbsp;*&nbsp;1.定义常量
&nbsp;*&nbsp;2.加载函数库
&nbsp;*&nbsp;3.运行框架
&nbsp;*/
define(&quot;PROJECT_PATH&quot;,realpath(&quot;./&quot;).&quot;/&quot;);
define(&quot;APP_PATH&quot;,PROJECT_PATH.&quot;app/&quot;);
define(&quot;CORE&quot;,PROJECT_PATH.&quot;core/&quot;);
define(&quot;MODULE&quot;,&#39;app&#39;);
define(&quot;DEBUG&quot;,true);
include(&quot;vendor/autoload.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//引入composer自动加载文件

if(DEBUG){
&nbsp;&nbsp;&nbsp;&nbsp;$whoops&nbsp;=&nbsp;new&nbsp;\\Whoops\\Run;
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;pushHandler(new&nbsp;\\Whoops\\Handler\\PrettyPageHandler);
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;register();
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;On&quot;);
}else{
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;Off&quot;);
}

include&nbsp;CORE.&quot;common/functions.php&quot;;
include&nbsp;CORE.&quot;core.php&quot;;
spl_autoload_register(&#39;core\\Core::load&#39;);
core\\Core::run();</pre><p>这里定义了几个常量。引入了common/function.php这个供系统使用的函数库。然后，引入框架核心文件core.php，最后调用core.php中的core类下的load方法进行自动加载配置。最后运行core类下的run方法运行整个框架。</p><p><br/></p><p>接下来我们看看框架的核心文件core.php。</p><p><br/></p><h3>core.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;框架核心文件，负责加载类，解析路由等
&nbsp;*/
namespace&nbsp;core;

class&nbsp;Core
{
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;$classMap&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;load($class){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classDir&nbsp;=&nbsp;str_replace(&quot;\\\\&quot;,&quot;/&quot;,$class);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classPath&nbsp;=&nbsp;PROJECT_PATH.$classDir.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($class,self::$classMap)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($classPath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$classPath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$classMap[]&nbsp;=&nbsp;$class;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;run(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router&nbsp;=&nbsp;new&nbsp;\\core\\lib\\Router();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrl&nbsp;=&nbsp;\\core\\lib\\Router::$ctrl;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$act&nbsp;=&nbsp;\\core\\lib\\Router::$act;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;=&nbsp;\\core\\lib\\Router::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlClass&nbsp;=&nbsp;&quot;\\\\&quot;.MODULE.&quot;\\\\controller\\\\&quot;.$ctrl.&quot;Controller&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj&nbsp;=&nbsp;new&nbsp;$ctrlClass();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj-&gt;$act();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>如果您曾经读过其他框架的源码，那么core.php将是你见过最短的框架核心文件。它只有两个方法。</p><p><br/></p><p>load方法用在index.php中来初始化自动加载。spl_autoload_register方法能接收带有命名空间的类名，并根据方法中定义的规则引入指定的类。</p><p><br/></p><p>run用在index.php启动整个框架。实际上它只做了一件事，就是将Router类中得到的控制器和方法名称拿来，拼接出我们最终需要进入的控制器和方法，并进行实例化和调用。<br/></p><p><br/></p><p>我们看到core类中只用到一个其他的类：Router。我们来看看它长什么样吧。</p><h3>Router</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Router
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$ctrl;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$act;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$params;

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_SERVER[&#39;REQUEST_URI&#39;]&nbsp;==&nbsp;&quot;/&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;Config::get(&quot;CTRL&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;&nbsp;=&nbsp;Config::get(&quot;ACTION&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathArr&nbsp;=&nbsp;explode(&quot;/&quot;,trim($_SERVER[&#39;REQUEST_URI&#39;],&quot;/&quot;));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathNum&nbsp;=&nbsp;count($pathArr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathNum&nbsp;==&nbsp;1){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;&quot;index&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if($pathNum&nbsp;==&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for($i&nbsp;=&nbsp;2;&nbsp;$i&nbsp;&lt;&nbsp;$pathNum&nbsp;-&nbsp;1&nbsp;;&nbsp;$i&nbsp;+=&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathArr[$i+1]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$params[$pathArr[$i]]&nbsp;=&nbsp;$pathArr[$i+1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_GET&nbsp;=&nbsp;self::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

}</pre><p>这个路由类只有一个构造函数。它的作用就是根据当前的url得到我们需要的控制器和方法名称，并把参数放到$_GET这个超全局变量中。</p><p><br/></p><p>这里使用了config类。这个类让我们可以很方便的管理我们的配置，比如路由配置，数据库配置，缓存配置等等，非常有用。</p><h3>config</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;配置加载类
&nbsp;*&nbsp;
&nbsp;*&nbsp;@author&nbsp;rww
&nbsp;*&nbsp;@date&nbsp;2016/11/06
&nbsp;*/
namespace&nbsp;core\\lib;

class&nbsp;Config
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$config&nbsp;=&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;根据对应的文件和key加载配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$key
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$file
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;get($key,&nbsp;$file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file][$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($config[$key]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$key&nbsp;not&nbsp;exist&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;加载所有配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;all($file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>config类只有两个方法。一个方法用来获取某文件中的某个配置，另一个方法用来获取某配置文件中的所有配置。<br/></p><p><br/></p><p>到这里，我们已经可以在对应的控制器里写业务逻辑了。我们来看看控制器。</p><h3>controller</h3><p>以IndexController为例：</p><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;app\\controller;
use&nbsp;core\\lib\\Model&nbsp;as&nbsp;Model;
use&nbsp;core\\lib\\Router&nbsp;as&nbsp;Router;
use&nbsp;core\\lib\\View&nbsp;as&nbsp;View;
class&nbsp;IndexController
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;addData(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;insert&nbsp;into&nbsp;z_post&nbsp;(title,content)&nbsp;values&nbsp;(&#39;this&nbsp;is&nbsp;test&#39;,&#39;this&nbsp;i&nbsp;test&#39;)&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pdo-&gt;insertData($sql)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;chenggong&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;a&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;b&#39;];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;select&nbsp;*&nbsp;from&nbsp;z_post&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$pdo-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view&nbsp;=&nbsp;new&nbsp;View();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;assign(&quot;data&quot;,$data[0]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;display();
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;p(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;pre&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump(Router::$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;Router::$params[&#39;id&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>先看index这个方法。在这里我们实例化Model类，得到pdo实例，并且执行了一条sql查询语句。然后实例化view类，输出了页面。逻辑很简单。我们接下来看看Model类和View类，看看数据对象的实例化和模板的使用。</p><h3>Model</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Model{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$instance=null;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$dbLink;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__construct($params=null){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;dsn&quot;&nbsp;=&gt;&nbsp;&quot;mysql:host=localhost;dbname=blog&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;username&quot;&nbsp;=&gt;&nbsp;&quot;root&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pwd&quot;&nbsp;=&gt;&nbsp;&quot;&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;option&quot;=&gt;&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\PDO::ATTR_ERRMODE&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;\\PDO::ERRMODE_EXCEPTION,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($params){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array_merge($options,$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink&nbsp;=&nbsp;new&nbsp;\\PDO($dsn,$username,$pwd,$options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink-&gt;exec(&quot;set&nbsp;names&nbsp;utf8&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__clone(){}&nbsp;&nbsp;//禁止克隆
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;getInstance(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!self::$instance&nbsp;instanceof&nbsp;self){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance&nbsp;=&nbsp;new&nbsp;self();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;insertData($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;dbLink-&gt;exec($sql);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;query($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$record&nbsp;=&nbsp;$this-&gt;dbLink-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($record){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$record-&gt;fetchAll(\\PDO::FETCH_ASSOC);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
}</pre><p>重点看一下getInstance和构造函数。这里单例模式的典型写法。这样每次我们getInstance得到的都是同一个实例。</p><h3>view</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;View
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$data&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;assign($name,$data){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[$name]&nbsp;=&nbsp;$data;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;display($filename=&quot;&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($this-&gt;data);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($filename){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.$filename;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.Router::$act.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($filePath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$filePath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(&#39;模版文件不存在&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>原理就是将assign方法使用到的数据放到data这个属性中。当display的时候，找到模板，并将分配过去的数据放到模板中。</p><p><br/></p><p>项目github地址：</p>',`mtime`='1479031185' WHERE `id` = 19 [ RunTime:0.0088s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0036s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0011s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0056s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0008s ]

[ 2016-11-13T17:59:47+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000011s ]
INFO: [ app_init ] --END-- [ RunTime:0.000269s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000556s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000630s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0013s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000166s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000201s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.016677s ]
INFO: [ view_parse ] --END-- [ RunTime:0.016707s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000437s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000466s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000804s ]
INFO: [ app_end ] --END-- [ RunTime:0.000836s ]

[ 2016-11-13T17:59:47+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000230s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000293s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000318s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0096s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0003s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0009s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000160s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000199s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.011695s ]
INFO: [ view_parse ] --END-- [ RunTime:0.011730s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000121s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000139s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000462s ]
INFO: [ app_end ] --END-- [ RunTime:0.000494s ]

[ 2016-11-13T18:01:02+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000021s ]
INFO: [ app_init ] --END-- [ RunTime:0.000927s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000949s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001064s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0028s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0003s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0019s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0018s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000216s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000266s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015092s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015171s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000452s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000512s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001146s ]
INFO: [ app_end ] --END-- [ RunTime:0.001201s ]

[ 2016-11-13T18:01:03+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000012s ]
INFO: [ app_init ] --END-- [ RunTime:0.000318s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000326s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000356s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0009s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0010s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0003s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000168s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000204s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.008853s ]
INFO: [ view_parse ] --END-- [ RunTime:0.008891s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000156s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000181s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000649s ]
INFO: [ app_end ] --END-- [ RunTime:0.000719s ]

[ 2016-11-13T18:01:18+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000015s ]
INFO: [ app_init ] --END-- [ RunTime:0.000888s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000986s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001051s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0015s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><h3>题外话<br/></h3><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h3>框架原理<br/></h3><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h3>目录</h3><p><img src=\"/ueditor/php/upload/image/20161113/1479029828670748.png\" title=\"1479029828670748.png\" alt=\"blob.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p>目录很简单。app里放业务。core里是核心文件和类库。.htaccess负责将请求指向index.php，入口文件index.php。我有理由相信，如果你对php的命名空间，自动加载，类和对象的知识比较熟悉的话，半个小时你就能掌握这个小东西。</p><p><br/></p><h3>index.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;入口文件
&nbsp;*&nbsp;1.定义常量
&nbsp;*&nbsp;2.加载函数库
&nbsp;*&nbsp;3.运行框架
&nbsp;*/
define(&quot;PROJECT_PATH&quot;,realpath(&quot;./&quot;).&quot;/&quot;);
define(&quot;APP_PATH&quot;,PROJECT_PATH.&quot;app/&quot;);
define(&quot;CORE&quot;,PROJECT_PATH.&quot;core/&quot;);
define(&quot;MODULE&quot;,&#39;app&#39;);
define(&quot;DEBUG&quot;,true);
include(&quot;vendor/autoload.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//引入composer自动加载文件

if(DEBUG){
&nbsp;&nbsp;&nbsp;&nbsp;$whoops&nbsp;=&nbsp;new&nbsp;\\Whoops\\Run;
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;pushHandler(new&nbsp;\\Whoops\\Handler\\PrettyPageHandler);
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;register();
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;On&quot;);
}else{
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;Off&quot;);
}

include&nbsp;CORE.&quot;common/functions.php&quot;;
include&nbsp;CORE.&quot;core.php&quot;;
spl_autoload_register(&#39;core\\Core::load&#39;);
core\\Core::run();</pre><p>这里定义了几个常量。引入了common/function.php这个供系统使用的函数库。然后，引入框架核心文件core.php，最后调用core.php中的core类下的load方法进行自动加载配置。最后运行core类下的run方法运行整个框架。</p><p><br/></p><p>接下来我们看看框架的核心文件core.php。</p><p><br/></p><h3>core.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;框架核心文件，负责加载类，解析路由等
&nbsp;*/
namespace&nbsp;core;

class&nbsp;Core
{
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;$classMap&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;load($class){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classDir&nbsp;=&nbsp;str_replace(&quot;\\\\&quot;,&quot;/&quot;,$class);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classPath&nbsp;=&nbsp;PROJECT_PATH.$classDir.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($class,self::$classMap)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($classPath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$classPath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$classMap[]&nbsp;=&nbsp;$class;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;run(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router&nbsp;=&nbsp;new&nbsp;\\core\\lib\\Router();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrl&nbsp;=&nbsp;\\core\\lib\\Router::$ctrl;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$act&nbsp;=&nbsp;\\core\\lib\\Router::$act;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;=&nbsp;\\core\\lib\\Router::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlClass&nbsp;=&nbsp;&quot;\\\\&quot;.MODULE.&quot;\\\\controller\\\\&quot;.$ctrl.&quot;Controller&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj&nbsp;=&nbsp;new&nbsp;$ctrlClass();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj-&gt;$act();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>如果您曾经读过其他框架的源码，那么core.php将是你见过最短的框架核心文件。它只有两个方法。</p><p><br/></p><p>load方法用在index.php中来初始化自动加载。spl_autoload_register方法能接收带有命名空间的类名，并根据方法中定义的规则引入指定的类。</p><p><br/></p><p>run用在index.php启动整个框架。实际上它只做了一件事，就是将Router类中得到的控制器和方法名称拿来，拼接出我们最终需要进入的控制器和方法，并进行实例化和调用。<br/></p><p><br/></p><p>我们看到core类中只用到一个其他的类：Router。我们来看看它长什么样吧。</p><h3>Router</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Router
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$ctrl;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$act;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$params;

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_SERVER[&#39;REQUEST_URI&#39;]&nbsp;==&nbsp;&quot;/&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;Config::get(&quot;CTRL&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;&nbsp;=&nbsp;Config::get(&quot;ACTION&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathArr&nbsp;=&nbsp;explode(&quot;/&quot;,trim($_SERVER[&#39;REQUEST_URI&#39;],&quot;/&quot;));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathNum&nbsp;=&nbsp;count($pathArr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathNum&nbsp;==&nbsp;1){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;&quot;index&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if($pathNum&nbsp;==&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for($i&nbsp;=&nbsp;2;&nbsp;$i&nbsp;&lt;&nbsp;$pathNum&nbsp;-&nbsp;1&nbsp;;&nbsp;$i&nbsp;+=&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathArr[$i+1]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$params[$pathArr[$i]]&nbsp;=&nbsp;$pathArr[$i+1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_GET&nbsp;=&nbsp;self::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

}</pre><p>这个路由类只有一个构造函数。它的作用就是根据当前的url得到我们需要的控制器和方法名称，并把参数放到$_GET这个超全局变量中。</p><p><br/></p><p>这里使用了config类。这个类让我们可以很方便的管理我们的配置，比如路由配置，数据库配置，缓存配置等等，非常有用。</p><h3>config</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;配置加载类
&nbsp;*&nbsp;
&nbsp;*&nbsp;@author&nbsp;rww
&nbsp;*&nbsp;@date&nbsp;2016/11/06
&nbsp;*/
namespace&nbsp;core\\lib;

class&nbsp;Config
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$config&nbsp;=&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;根据对应的文件和key加载配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$key
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$file
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;get($key,&nbsp;$file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file][$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($config[$key]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$key&nbsp;not&nbsp;exist&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;加载所有配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;all($file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>config类只有两个方法。一个方法用来获取某文件中的某个配置，另一个方法用来获取某配置文件中的所有配置。<br/></p><p><br/></p><p>到这里，我们已经可以在对应的控制器里写业务逻辑了。我们来看看控制器。</p><h3>controller</h3><p>以IndexController为例：</p><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;app\\controller;
use&nbsp;core\\lib\\Model&nbsp;as&nbsp;Model;
use&nbsp;core\\lib\\Router&nbsp;as&nbsp;Router;
use&nbsp;core\\lib\\View&nbsp;as&nbsp;View;
class&nbsp;IndexController
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;addData(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;insert&nbsp;into&nbsp;z_post&nbsp;(title,content)&nbsp;values&nbsp;(&#39;this&nbsp;is&nbsp;test&#39;,&#39;this&nbsp;i&nbsp;test&#39;)&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pdo-&gt;insertData($sql)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;chenggong&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;a&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;b&#39;];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;select&nbsp;*&nbsp;from&nbsp;z_post&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$pdo-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view&nbsp;=&nbsp;new&nbsp;View();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;assign(&quot;data&quot;,$data[0]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;display();
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;p(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;pre&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump(Router::$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;Router::$params[&#39;id&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>先看index这个方法。在这里我们实例化Model类，得到pdo实例，并且执行了一条sql查询语句。然后实例化view类，输出了页面。逻辑很简单。我们接下来看看Model类和View类，看看数据对象的实例化和模板的使用。</p><h3>Model</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Model{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$instance=null;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$dbLink;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__construct($params=null){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;dsn&quot;&nbsp;=&gt;&nbsp;&quot;mysql:host=localhost;dbname=blog&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;username&quot;&nbsp;=&gt;&nbsp;&quot;root&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pwd&quot;&nbsp;=&gt;&nbsp;&quot;&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;option&quot;=&gt;&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\PDO::ATTR_ERRMODE&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;\\PDO::ERRMODE_EXCEPTION,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($params){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array_merge($options,$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink&nbsp;=&nbsp;new&nbsp;\\PDO($dsn,$username,$pwd,$options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink-&gt;exec(&quot;set&nbsp;names&nbsp;utf8&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__clone(){}&nbsp;&nbsp;//禁止克隆
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;getInstance(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!self::$instance&nbsp;instanceof&nbsp;self){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance&nbsp;=&nbsp;new&nbsp;self();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;insertData($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;dbLink-&gt;exec($sql);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;query($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$record&nbsp;=&nbsp;$this-&gt;dbLink-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($record){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$record-&gt;fetchAll(\\PDO::FETCH_ASSOC);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
}</pre><p>重点看一下getInstance和构造函数。这里单例模式的典型写法。这样每次我们getInstance得到的都是同一个实例。</p><h3>view</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;View
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$data&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;assign($name,$data){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[$name]&nbsp;=&nbsp;$data;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;display($filename=&quot;&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($this-&gt;data);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($filename){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.$filename;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.Router::$act.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($filePath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$filePath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(&#39;模版文件不存在&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>原理就是将assign方法使用到的数据放到data这个属性中。当display的时候，找到模板，并将分配过去的数据放到模板中。</p><p><br/></p><p>项目github地址：</p><p>							</p>',`mtime`='1479031278' WHERE `id` = 19 [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0003s ]

[ 2016-11-13T18:01:20+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000232s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000292s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000317s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0013s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0007s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0006s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000154s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000181s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.013948s ]
INFO: [ view_parse ] --END-- [ RunTime:0.013972s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.002301s ]
INFO: [ view_filter ] --END-- [ RunTime:0.002357s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001328s ]
INFO: [ app_end ] --END-- [ RunTime:0.001379s ]

[ 2016-11-13T18:01:20+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000032s ]
INFO: [ app_init ] --END-- [ RunTime:0.000999s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000950s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001007s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0101s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0007s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000204s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000254s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.015290s ]
INFO: [ view_parse ] --END-- [ RunTime:0.015326s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000124s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000143s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000470s ]
INFO: [ app_end ] --END-- [ RunTime:0.000504s ]

[ 2016-11-13T18:35:41+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000008s ]
INFO: [ app_init ] --END-- [ RunTime:0.000236s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000427s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000465s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0018s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0006s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0014s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0012s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000214s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000298s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.017561s ]
INFO: [ view_parse ] --END-- [ RunTime:0.017605s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000154s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000175s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000554s ]
INFO: [ app_end ] --END-- [ RunTime:0.000599s ]

[ 2016-11-13T18:35:42+08:00 ] 127.0.0.1 /admin.php/Post/updatePost/id/19
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000009s ]
INFO: [ app_init ] --END-- [ RunTime:0.000223s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000278s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000304s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0021s ]
SQL: SELECT * FROM `z_post` WHERE `id` = 19 LIMIT 1   [ RunTime:0.0004s ]
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0018s ]
SQL: SELECT * FROM `z_category`  [ RunTime:0.0005s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0026s ]
SQL: SELECT * FROM `z_tag`  [ RunTime:0.0002s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000180s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000229s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/b94d69ac1621e983387ec69783f12599.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.008911s ]
INFO: [ view_parse ] --END-- [ RunTime:0.008939s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000132s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000155s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000447s ]
INFO: [ app_end ] --END-- [ RunTime:0.000485s ]

[ 2016-11-13T18:36:12+08:00 ] 127.0.0.1 /admin.php/Ajax/addNewPost
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000016s ]
INFO: [ app_init ] --END-- [ RunTime:0.000837s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001047s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001111s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0015s ]
SQL: UPDATE `z_post` SET `title`='php框架原理',`category`='php',`tag`='框架',`summary`='框架完成项目中的基础布置，让开发人员将更多的经历放在业务的实现上。',`content`='<p>								</p><p><br/></p><h3>题外话<br/></h3><p>不知道怎么去表达。只希望能够帮到有需要的同学。</p><p>这将是个简单的不能再简单的mvc框架，但是足以让你了解框架的奥秘了。</p><h3>框架原理<br/></h3><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>首先你需要做rewrite重写，将网站的所有请求指向到你的index.php来实现单一入口。</p></li><li><p>一般我们在index.php中定义很多的常亮，比如项目目录，框架核心文件目录，业务目录，静态文件目录等等。除了定义这些常量之外，我们只需要做另外一件事：启动框架。（这都是套路）</p></li><li><p>启动框架实际上就是实现路由寻址。所谓路由寻址，就是将url指向到对应的控制器和方法，并且保存参数以供使用。</p></li><li><p>接下来在根据路由得到的控制器和方法里写业务逻辑。</p></li><li><p>最后将业务逻辑中得到的数据分配到模板就完事了。</p></li></ol><p>是不是很简单呢？接下来我们来熟悉一下这个框架。</p><h3>目录</h3><p><img src=\"/ueditor/php/upload/image/20161113/1479029828670748.png\" title=\"1479029828670748.png\" alt=\"blob.png\"/></p><p><br/></p><p>这里可以先忽略vendor目录和composer.json以及composer.lock这三个文件。这是框架写完之后，利用了 composer 来扩展框架的健壮性。<br/></p><p><br/></p><p>目录很简单。app里放业务。core里是核心文件和类库。.htaccess负责将请求指向index.php，入口文件index.php。我有理由相信，如果你对php的命名空间，自动加载，类和对象的知识比较熟悉的话，半个小时你就能掌握这个小东西。</p><p><br/></p><h3>index.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;入口文件
&nbsp;*&nbsp;1.定义常量
&nbsp;*&nbsp;2.加载函数库
&nbsp;*&nbsp;3.运行框架
&nbsp;*/
define(&quot;PROJECT_PATH&quot;,realpath(&quot;./&quot;).&quot;/&quot;);
define(&quot;APP_PATH&quot;,PROJECT_PATH.&quot;app/&quot;);
define(&quot;CORE&quot;,PROJECT_PATH.&quot;core/&quot;);
define(&quot;MODULE&quot;,&#39;app&#39;);
define(&quot;DEBUG&quot;,true);
include(&quot;vendor/autoload.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//引入composer自动加载文件

if(DEBUG){
&nbsp;&nbsp;&nbsp;&nbsp;$whoops&nbsp;=&nbsp;new&nbsp;\\Whoops\\Run;
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;pushHandler(new&nbsp;\\Whoops\\Handler\\PrettyPageHandler);
&nbsp;&nbsp;&nbsp;&nbsp;$whoops-&gt;register();
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;On&quot;);
}else{
&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;display_errors&quot;,&quot;Off&quot;);
}

include&nbsp;CORE.&quot;common/functions.php&quot;;
include&nbsp;CORE.&quot;core.php&quot;;
spl_autoload_register(&#39;core\\Core::load&#39;);
core\\Core::run();</pre><p>这里定义了几个常量。引入了common/function.php这个供系统使用的函数库。然后，引入框架核心文件core.php，最后调用core.php中的core类下的load方法进行自动加载配置。最后运行core类下的run方法运行整个框架。</p><p><br/></p><p>接下来我们看看框架的核心文件core.php。</p><p><br/></p><h3>core.php</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;框架核心文件，负责加载类，解析路由等
&nbsp;*/
namespace&nbsp;core;

class&nbsp;Core
{
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;$classMap&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;load($class){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classDir&nbsp;=&nbsp;str_replace(&quot;\\\\&quot;,&quot;/&quot;,$class);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classPath&nbsp;=&nbsp;PROJECT_PATH.$classDir.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($class,self::$classMap)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($classPath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$classPath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$classMap[]&nbsp;=&nbsp;$class;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;run(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router&nbsp;=&nbsp;new&nbsp;\\core\\lib\\Router();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrl&nbsp;=&nbsp;\\core\\lib\\Router::$ctrl;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$act&nbsp;=&nbsp;\\core\\lib\\Router::$act;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;=&nbsp;\\core\\lib\\Router::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlClass&nbsp;=&nbsp;&quot;\\\\&quot;.MODULE.&quot;\\\\controller\\\\&quot;.$ctrl.&quot;Controller&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj&nbsp;=&nbsp;new&nbsp;$ctrlClass();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ctrlObj-&gt;$act();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>如果您曾经读过其他框架的源码，那么core.php将是你见过最短的框架核心文件。它只有两个方法。</p><p><br/></p><p>load方法用在index.php中来初始化自动加载。spl_autoload_register方法能接收带有命名空间的类名，并根据方法中定义的规则引入指定的类。</p><p><br/></p><p>run用在index.php启动整个框架。实际上它只做了一件事，就是将Router类中得到的控制器和方法名称拿来，拼接出我们最终需要进入的控制器和方法，并进行实例化和调用。<br/></p><p><br/></p><p>我们看到core类中只用到一个其他的类：Router。我们来看看它长什么样吧。</p><h3>Router</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Router
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$ctrl;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$act;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$params;

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_SERVER[&#39;REQUEST_URI&#39;]&nbsp;==&nbsp;&quot;/&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;Config::get(&quot;CTRL&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;&nbsp;=&nbsp;Config::get(&quot;ACTION&quot;,&quot;router.php&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathArr&nbsp;=&nbsp;explode(&quot;/&quot;,trim($_SERVER[&#39;REQUEST_URI&#39;],&quot;/&quot;));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pathNum&nbsp;=&nbsp;count($pathArr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathNum&nbsp;==&nbsp;1){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;&quot;index&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if($pathNum&nbsp;==&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$ctrl&nbsp;=&nbsp;$pathArr[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$act&nbsp;=&nbsp;$pathArr[1];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for($i&nbsp;=&nbsp;2;&nbsp;$i&nbsp;&lt;&nbsp;$pathNum&nbsp;-&nbsp;1&nbsp;;&nbsp;$i&nbsp;+=&nbsp;2){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pathArr[$i+1]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$params[$pathArr[$i]]&nbsp;=&nbsp;$pathArr[$i+1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_GET&nbsp;=&nbsp;self::$params;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}

}</pre><p>这个路由类只有一个构造函数。它的作用就是根据当前的url得到我们需要的控制器和方法名称，并把参数放到$_GET这个超全局变量中。</p><p><br/></p><p>这里使用了config类。这个类让我们可以很方便的管理我们的配置，比如路由配置，数据库配置，缓存配置等等，非常有用。</p><h3>config</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
/**
&nbsp;*&nbsp;配置加载类
&nbsp;*&nbsp;
&nbsp;*&nbsp;@author&nbsp;rww
&nbsp;*&nbsp;@date&nbsp;2016/11/06
&nbsp;*/
namespace&nbsp;core\\lib;

class&nbsp;Config
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$config&nbsp;=&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;根据对应的文件和key加载配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$key
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$file
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;get($key,&nbsp;$file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file][$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($config[$key]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$key];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$key&nbsp;not&nbsp;exist&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;/**
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;加载所有配置
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;all($file)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($config[$file]))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config[$file];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;CORE.&quot;config/&quot;.$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file_exists($filePath))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self::$config[$file]&nbsp;=&nbsp;$config&nbsp;=&nbsp;include($filePath);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$config;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\\Exception(&quot;$filePath&nbsp;not&nbsp;found&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>config类只有两个方法。一个方法用来获取某文件中的某个配置，另一个方法用来获取某配置文件中的所有配置。<br/></p><p><br/></p><p>到这里，我们已经可以在对应的控制器里写业务逻辑了。我们来看看控制器。</p><h3>controller</h3><p>以IndexController为例：</p><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;app\\controller;
use&nbsp;core\\lib\\Model&nbsp;as&nbsp;Model;
use&nbsp;core\\lib\\Router&nbsp;as&nbsp;Router;
use&nbsp;core\\lib\\View&nbsp;as&nbsp;View;
class&nbsp;IndexController
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;addData(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;insert&nbsp;into&nbsp;z_post&nbsp;(title,content)&nbsp;values&nbsp;(&#39;this&nbsp;is&nbsp;test&#39;,&#39;this&nbsp;i&nbsp;test&#39;)&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pdo-&gt;insertData($sql)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;chenggong&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;a&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_GET[&#39;b&#39;];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo&nbsp;=&nbsp;Model::getInstance();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;select&nbsp;*&nbsp;from&nbsp;z_post&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$pdo-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view&nbsp;=&nbsp;new&nbsp;View();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;assign(&quot;data&quot;,$data[0]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$view-&gt;display();
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;p(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;pre&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump(Router::$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;Router::$params[&#39;id&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>先看index这个方法。在这里我们实例化Model类，得到pdo实例，并且执行了一条sql查询语句。然后实例化view类，输出了页面。逻辑很简单。我们接下来看看Model类和View类，看看数据对象的实例化和模板的使用。</p><h3>Model</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;Model{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;$instance=null;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$dbLink;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__construct($params=null){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;dsn&quot;&nbsp;=&gt;&nbsp;&quot;mysql:host=localhost;dbname=blog&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;username&quot;&nbsp;=&gt;&nbsp;&quot;root&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;pwd&quot;&nbsp;=&gt;&nbsp;&quot;&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;option&quot;=&gt;&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\PDO::ATTR_ERRMODE&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;\\PDO::ERRMODE_EXCEPTION,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($params){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options&nbsp;=&nbsp;array_merge($options,$params);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink&nbsp;=&nbsp;new&nbsp;\\PDO($dsn,$username,$pwd,$options);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;dbLink-&gt;exec(&quot;set&nbsp;names&nbsp;utf8&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;__clone(){}&nbsp;&nbsp;//禁止克隆
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;getInstance(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!self::$instance&nbsp;instanceof&nbsp;self){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance&nbsp;=&nbsp;new&nbsp;self();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self::$instance;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;insertData($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;dbLink-&gt;exec($sql);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;query($sql){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$record&nbsp;=&nbsp;$this-&gt;dbLink-&gt;query($sql);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($record){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$record-&gt;fetchAll(\\PDO::FETCH_ASSOC);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
}</pre><p>重点看一下getInstance和构造函数。这里单例模式的典型写法。这样每次我们getInstance得到的都是同一个实例。</p><h3>view</h3><pre class=\"brush:php;toolbar:false\">&lt;?php
namespace&nbsp;core\\lib;

class&nbsp;View
{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$data&nbsp;=&nbsp;array();

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;assign($name,$data){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[$name]&nbsp;=&nbsp;$data;
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;display($filename=&quot;&quot;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extract($this-&gt;data);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($filename){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.$filename;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;APP_PATH.&quot;view/&quot;.Router::$ctrl.&quot;/&quot;.Router::$act.&quot;.php&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_file($filePath)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;$filePath;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(&#39;模版文件不存在&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>原理就是将assign方法使用到的数据放到data这个属性中。当display的时候，找到模板，并将分配过去的数据放到模板中。</p><p><br/></p><p>项目github地址：https://github.com/ruanwenwu/rwwfrm</p><p><br/></p><p>							</p>',`mtime`='1479033372' WHERE `id` = 19 [ RunTime:0.0054s ]
NOTIC: [8] Undefined variable: id /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Admin/Controller/AjaxController.class.php 第 56 行.
SQL: SHOW COLUMNS FROM `z_category` [ RunTime:0.0015s ]
SQL: SELECT * FROM `z_category` WHERE `name` = 'php' LIMIT 1   [ RunTime:0.0002s ]
SQL: SHOW COLUMNS FROM `z_tag` [ RunTime:0.0013s ]
SQL: SELECT * FROM `z_tag` WHERE `name` = '框架' LIMIT 1   [ RunTime:0.0004s ]

[ 2016-11-13T18:36:14+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000007s ]
INFO: [ app_init ] --END-- [ RunTime:0.000194s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000287s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000309s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0024s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0005s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0005s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000221s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000278s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.017321s ]
INFO: [ view_parse ] --END-- [ RunTime:0.017350s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000726s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000756s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001037s ]
INFO: [ app_end ] --END-- [ RunTime:0.001091s ]

[ 2016-11-13T18:36:14+08:00 ] 127.0.0.1 /admin.php/Post/all
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000007s ]
INFO: [ app_init ] --END-- [ RunTime:0.000192s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000241s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000263s ]
SQL: SHOW COLUMNS FROM `z_post` [ RunTime:0.0104s ]
SQL: SELECT COUNT(*) AS tp_count FROM `z_post` LIMIT 1   [ RunTime:0.0004s ]
SQL: SELECT * FROM `z_post` ORDER BY ctime desc LIMIT 0,20   [ RunTime:0.0007s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000160s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000196s ]
NOTIC: [8] Undefined variable: userInfo /Applications/XAMPP/xamppfiles/htdocs/blog/Application/Runtime/Cache/Admin/c171e2b85832ae9943251ee8295bfacb.php 第 371 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.012198s ]
INFO: [ view_parse ] --END-- [ RunTime:0.012227s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.000120s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000138s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.000449s ]
INFO: [ app_end ] --END-- [ RunTime:0.000484s ]

